<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>会员管理</title>
  <meta name="description" content="mobile first, app, web app, responsive, admin dashboard, flat, flat ui">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<link rel="stylesheet" href="css/bootstrap.css">
  <link rel="stylesheet" href="css/font-awesome.min.css">
	<link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="css/plugin.css">
  <link rel="stylesheet" href="css/landing.css">  <link rel="stylesheet" href="css/b.page.bootstrap3.css" />  <link rel="stylesheet" href="css/b.page.css" />  <link rel="stylesheet" href="css/sweetalert2.css" />  <link rel="stylesheet" href="http://www.jq22.com/jquery/font-awesome.4.6.0.css" /> <!--  <link rel="stylesheet" href="vendor/bootstrap/css/bootstrap.css"/> -->  <link rel="stylesheet" href="dist/css/formValidation.css"/>	<link rel="stylesheet" type="text/css" href="css/default.css">

</head><style type="text/css">.table-btn{	height:50%;	margin:3px 5px;	padding:5px 5px;}</style>
<body>
  <!-- header -->
	<header id="header" class="navbar">
    <ul class="nav navbar-nav navbar-avatar pull-right">
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">
          <span class="hidden-sm-only">Mika Sokeil</span>
          <span class="thumb-small avatar inline"><img src="images/avatar.jpg" alt="Mika Sokeil" class="img-circle"></span>
          <b class="caret hidden-sm-only"></b>
        </a>
        <ul class="dropdown-menu">
         <!--  <li><a href="#">Settings</a></li> -->
          <li><a href="#">Profile</a></li>
          <li><a href="#"><span class="badge bg-danger pull-right">3</span>Notifications</a></li>
          <li class="divider"></li>
          <li><a href="docs.html">Help</a></li>
          <li><a href="signin.html">Logout</a></li>
        </ul>
      </li>
    </ul>
    <a class="navbar-brand" href="#">随身拍</a>
    <button type="button" class="btn btn-link pull-left nav-toggle hidden-lg" data-toggle="class:slide-nav slide-nav-left" data-target="body">
      <i class="icon-reorder icon-xlarge text-default"></i>
    </button>
    <ul class="nav navbar-nav hidden-sm">

      <li><div class="m-t-small"><a class="btn btn-small btn-info" data-toggle="modal" href="#modal"><i class="icon-plus"></i> POST</a></div></li>
      <li class="dropdown shift" data-toggle="shift:appendTo" data-target=".nav-primary .nav">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="icon-cog icon-xlarge visible-sm visible-sm-inline"></i>设置 <b class="caret hidden-sm-only"></b></a>
        <ul class="dropdown-menu">
          <li>
            <a href="#" data-toggle="class:navbar-fixed" data-target='body'>工具栏
              <span class="text-active">自定义</span>
              <span class="text">固定</span>
            </a>
          </li>
          <li class="visible-lg">
            <a href="#" data-toggle="class:nav-vertical" data-target="#nav">工具栏
              <span class="text-active">垂直</span>
              <span class="text">水平</span>
            </a>
          </li>
          <li class="divider hidden-sm"></li>

          <li>
            <a href="#" data-toggle="class:bg bg-black" data-target='.navbar'>工具横栏
              <span class="text-active">白色</span>
              <span class="text">暗色</span>
            </a>
          </li>
          <li>
            <a href="#" data-toggle="class:bg-light" data-target='#nav'>工具竖栏
              <span class="text-active">暗色</span>
              <span class="text">白色</span>
            </a>
          </li>
        </ul>
      </li>
    </ul>
    <form class="navbar-form pull-left shift" action="" data-toggle="shift:appendTo" data-target=".nav-primary">
      <i class="icon-search text-muted"></i>
      <input type="text" class="input-small form-control" placeholder="Search">
    </form>
	</header>
  <!-- / header -->
  <!-- nav -->
  <nav id="nav" class="nav-primary visible-lg nav-vertical">
    <ul class="nav" data-spy="affix" data-offset-top="50">
      <li class="active"><a href="index.html"><i class="icon-dashboard icon-xlarge"></i>主页</a></li>
      <li class="dropdown-submenu">
        <a href="#"><i class="icon-th icon-xlarge"></i>摄影管理</a>
        <ul class="dropdown-menu">
          <li><a href="buttons.html">Buttons</a></li>
          <li><a href="icons.html"><b class="badge pull-right">302</b>Icons</a></li>
          <li><a href="grid.html">Grid</a></li>
          <li><a href="widgets.html"><b class="badge bg-primary pull-right">8</b>Widgets</a></li>
          <li><a href="components.html"><b class="badge pull-right">18</b>Components</a></li>
        </ul>
      </li>
      <li class="dropdown-submenu">
        <a href="#"><i class="icon-list icon-xlarge"></i>基础资料管理</a>
        <ul class="dropdown-menu">
          <li><a href="list.html">客户信息管理</a></li>
          <li><a href="table.html">员工信息管理</a></li>
        </ul>
      </li>      <li class="dropdown-submenu">        <a href="#"><i class="icon-edit icon-xlarge"></i>会员管理</a>        <ul class="dropdown-menu">          <li><a href="member2.html">卡档案管理</a></li>          <li><a href="memberDiscount.html">优惠方案</a></li>        </ul>      </li>      <li class="dropdown-submenu">        <a href="#"><i class="icon-signal icon-xlarge"></i>设备管理</a>        <ul class="dropdown-menu">          <li><a href="list.html">拍照设备管理</a></li>          <li><a href="table.html">服装管理</a></li>        </ul>      </li>      <li class="dropdown-submenu">        <a href="#"><i class="icon-signal icon-xlarge"></i>产品及套系管理</a>        <ul class="dropdown-menu">          <li><a href="list.html">产品类别设置</a></li>          <li><a href="table.html">产品设置</a></li>          <li><a href="list.html">套系设置</a></li>          <li><a href="table.html">套系产品设置</a></li>          <li><a href="list.html">产品销售统计</a></li>        </ul>      </li>      <li class="dropdown-submenu">        <a href="#"><i class="icon-signal icon-xlarge"></i>财务信息管理</a>        <ul class="dropdown-menu">          <li><a href="list.html">业绩管理</a></li>          <li><a href="table.html">费用管理</a></li>        </ul>      </li>

    </ul>
  </nav>
  <!-- / nav -->
  <section id="content" >
<section class="panel">        	<a type="button" data-toggle="modal" data-backdrop="static" href="#modal"  class="btn btn-info">添加</a>			<button type="button" onclick="deleteDoctor();"  class="btn btn-info">删除</button>			<form class="form-inline" style="float:right;"  role="form">				<div class="col-lg-9">				    <input type="text" id="searchDocName" class="form-control"  placeholder="请输入会员名称或会员卡号进行查询">				    </div>				   	<button type="button" onclick="searchAreaData();"  class="btn btn-info">查询</button>			</form>			</section>			<section class="panel">  				<table id="dataGridTableJson" class="table table-striped table-bordered table-striped with-check table-hover table-condensed">              <thead>                <tr>                  <th>卡号</th>                  <th>姓名</th>                  <th>性别</th>                  <th>年龄</th>                  <th>会员等级</th>                  <th>联系电话</th>                  <th>操作</th>                </tr>              </thead>              <tbody>              </tbody>            </table>			<div id="page3"></div>          </section>
  </section>
  <!-- .modal -->
  <div id="modal" class="modal fade">
      <div class="modal-dialog pos-abt" style="margin-top:-235px; top:50%">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true"><i class="icon-remove"></i></button>
            <h4 class="modal-title" id="myModalLabel">添加会员信息</h4>
          </div>
          <div class="modal-body">	        <div class="row">	            <div class="col-sm-10 col-sm-offset-2">	                <!-- <div class="page-header">	                    <h2>Bootstrap Form</h2>	                </div> -->	                <form id="defaultForm" method="post" class="form-horizontal" action="member/add"> 					<div class="form-group">		                <label class="col-lg-3 control-label">姓名</label>		                <div class="col-lg-9">		                  <input type="text" name="username" placeholder="用户姓名" class="form-control" >							<!-- <div class="line line-dashed m-t-large"></div> -->		                </div>	              </div>	              <div class="form-group">	                <label class="col-lg-3 control-label">身份证号</label>	                <div class="col-lg-9">	                  <input type="text" name="cardNumber" placeholder="身份证号码"  class="form-control">	                </div>	              </div>              <div class="form-group">                <label class="col-lg-3 control-label">联系方式</label>                <div class="col-lg-9">                  <input type="text" name="phone" placeholder="联系电话"  class="form-control">                  <div class="line line-dashed m-t-large"></div>                </div>              </div>              <div class="form-group">                <label class="col-lg-3 control-label">会员级别</label>                <div class="col-lg-4">                  <select  id="selectDiscount" name="discountId" class="form-control">                  </select>				<div class="line line-dashed m-t-large"></div>                </div>              </div>	                    <div class="form-group">			                <div class="col-lg-12 col-offset-3">			                  <button  data-dismiss="modal"  class="btn btn-white">取消</button>			                  <button type="submit" class="btn btn-primary">添加</button>			                </div>			              </div>	                </form>	            </div>	        </div>          </div>
        </div><!-- /.modal-content -->
      </div>
  </div>
  <!-- / .modal -->
  <!-- footer -->
  <footer id="footer">    <div class="text-center padder clearfix">      <p>        <small>&copy; 随身拍 2018 | 东北林业大学  | 冯文秀</small><br><br>      </p>    </div>  </footer>
  <a href="#" class="hide slide-nav-block" data-toggle="class:slide-nav slide-nav-left" data-target="body"></a>
  <!-- / footer -->
	<script src="js/jquery.min.js"></script>
  <!-- Bootstrap -->
  <script src="js/bootstrap.js"></script>  <script src="js/parsley/parsley.js"></script>
  <!-- app -->
 <script type="text/javascript" src="vendor/jquery/jquery.min.js"></script>    <script type="text/javascript" src="vendor/bootstrap/js/bootstrap.min.js"></script>    <script type="text/javascript" src="dist/js/formValidation.js"></script>    <script type="text/javascript" src="dist/js/framework/bootstrap.js"></script>    <script type="text/javascript" src="dist/js/language/zh_CN.js"></script>      <script src="js/sweetalert2.min.js"></script>
  <script src="js/ie/excanvas.js"></script>  <script src="js/b.page.js"></script>  <script type="text/javascript">  $(function(){	  /*	 	 在页面开始加载的时候将会员卡相关的数据初始化进去	  */	  var selectDiscount = $("select#selectDiscount");		//向后台发送get请求，接收用户数据		$.get("memberdiscount/list",{},function(data){			//然后将人员数据导入到下拉列表中			var result = data.data.list;			//alert(result);			console.log(result);			for(var i = 0;i < result.length; i++){				selectDiscount.append($("<option value='"+result[i].id+"'>"+result[i].cardTypeName+"</option>"));			}		});		/*		*	在页面加载的时候取数据		*/		loadTableData();		/**/	});	function loadTableData(){		//每次方法执行之前把全局变量清空		dataObj = [];		$('#page3').bPage({			url:'member/datagrid',		    //开启异步处理模式		    asyncLoad : true,		    //关闭服务端页面模式		    serverSidePage : false,		    //数据自定义填充		    render : function(data){		    	var result = data.data;		    	console.log(result);		        var tb = $('#dataGridTableJson tbody');		        $(tb).empty();		        if(result && result.list && result.list.length > 0){		            $.each(result.list,function(i,row){		            	var singleData = row;		                  var sex = "男";		                  if(parseInt(singleData.sex) == 1){		                	  sex = "女";		                  }						var trData = "<tr class='gradeA' id='"+singleData.id+"'>"+														"<td>"+singleData.cardNumber+"</td>"+														"<td>"+singleData.username+"</td>"+														"<td>"+sex+"</td>"+														"<td>"+singleData.age+"</td>"+														"<td>"+singleData.memberLevel+"</td>"+														"<td>"+singleData.phone+"</td>"+														"<td>"+		                  									"<a class='btn table-btn' href='#' onclick=updateDoctor(\'"+singleData.id+"\'); >修改</a>"+		                  									"<a class='btn table-btn' onclick=deleteMember(\'"+singleData.id+"\'); >删除</a>"+		                  								"</td></tr>";			                /*这边需要记住的一个问题是，在onclick中传字符串是可以的，但是传递object对象就会出现错误*/		                $(tb).append(trData);		                dataObj.push(singleData);						});			        }			    },		    params : function(){				var doctorName = $("#searchDocName").val();		    	//alert("assetNo="+assetNumber+",person="+assetPersonId+",assetStatus="+assetStatus);		        return {		        	username : doctorName		        };		    }		});	}	$(document).ready(function() {	    $('#defaultForm').formValidation({	        message: 'This value is not valid',	        icon: {	            valid: 'glyphicon glyphicon-ok',	            invalid: 'glyphicon glyphicon-remove',	            validating: 'glyphicon glyphicon-refresh'	        },	        fields: {	            username: {	                message: '用户名不合法',	                validators: {	                    notEmpty: {	                        message: '用户名必须设置'	                    },	                    stringLength: {	                        min: 2,	                        max: 30,	                        message: '用户名必须在2-30个字符之间'	                    },	                    regexp: {	                        regexp: /^[\u4e00-\u9fa5|0-9A-z]+$/,	                        message: '用户名必须由字母、汉字、数字和下划线组成'	                    }	                }	            },	            cardNumber: {	                validators: {	                    notEmpty: {	                        message: '身份证号码不能为空'	                    },	                    regexp: {	                        regexp: /^[1-9]{1}[0-9]{14}$|^[1-9]{1}[0-9]{16}([0-9]|[xX])$/,	                        message: '身份证号格式错误'	                    }	                }	            },	            phone: {	                validators: {	                    notEmpty: {	                        message: '手机号码不能为空'	                    },	                    regexp: {	                        regexp: /^[1][3,4,5,7,8][0-9]{9}$/,	                        message: '身份证号格式错误'	                    }	                }	            }	        }	    }).on('success.form.fv', function(e) {            // Prevent submit form            e.preventDefault();            var $form     = $(e.target),                validator = $form.data('formValidation');            $.post($form.attr('action'), $form.serialize(), function(result) {                console.log(result);                var ret = result.result;                if(parseInt(ret) == 200){                	$("#modal").modal("hide");                	$(".modal-backdrop").hide();	                /*添加成功之后需要将数据回显到数据表格中*/                	loadTableData();	                $('.bPageRight:first').remove();                }else{                	swal("会员数据添加错误！");                }            }, 'json');	    });	});	/*删除数据*/	function deleteMember(areaId){		alert("areaId="+areaId);		swal({			  title: "确定删除吗？",			  text: "你将无法恢复该数据！",			  type: "warning",			  showCancelButton: true,			  confirmButtonColor: "#DD6B55",			  cancelButtonText: "取消删除！",			  confirmButtonText: "确定删除！",			  closeOnConfirm: false,			  closeOnCancel: false			}).then(function(isConfirm){				if (isConfirm) {					var data = {};					data.id = areaId;					$.ajax({						url:'member/delete',						type:'GET',						data:data,						dataType:'json',						success:function(data){							swal('提示','该数据已被成功删除','success').then(function(isConfirm){								$("#"+areaId).remove();								$('.bPageRight:first').remove();								loadTableData();							});						},						error:function(){							swal('提示','删除数据时出错','error');						}					});				  } else {				    //swal("取消！", "已经取消的删除","error");				  }			});	}  </script>
</body>
</html>